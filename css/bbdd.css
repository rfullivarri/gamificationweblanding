/* =========================================
   BBDD Editor ‚Äî CSS can√≥nico (dashboard look)
   ========================================= */

/* --- Tokens --- */
:root{
  --brand:#7d3cff;
  --ink:#ecedff;
  --ink-soft:#cfd3ff;
  --bg:#0b1020;
  --panel-0:#0e1224;
  --panel-1:#121736;
  --glass-1: rgba(18,22,45,.75);
  --glass-2: rgba(12,16,35,.75);
  --line: rgba(122,134,255,.18);
  --line-soft: rgba(122,134,255,.14);
  --chip:#1b2247;
  --ok:#1ec28b;
  --danger:#ff5364;
  --input-bg: rgba(12,16,36,.6);
  --input-brd: rgba(122,134,255,.22);
}

/* --- Base --- */
*{ box-sizing:border-box; }
html,body{
  margin:0; padding:0;
  background:#0c1020;
  color:var(--ink);
  font-family:"Inter",ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto;
}

/* --- Overlay/Panel (glass) --- */
.bbdd-overlay{
  position:fixed; inset:0; z-index:9999;
  display:flex; align-items:center; justify-content:center;
  padding:24px;
  background: rgba(6,8,18,.55);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
}
.bbdd-overlay.hidden{ display:none; }

.bbdd-panel{
  width:min(1200px,100%);
  height:min(90vh,100%);
  display:flex; flex-direction:column;
  border:1px solid var(--line);
  border-radius:14px;
  background: linear-gradient(180deg,var(--glass-1),var(--glass-2));
  box-shadow: 0 24px 80px rgba(0,0,0,.55), inset 0 1px 0 rgba(255,255,255,.04);
}
@media (max-width:768px){
  .bbdd-overlay{ padding:0; }
  .bbdd-panel{ width:100%; height:100%; border-radius:0; }
}

/* --- Header --- */
.bbdd-header{
  display:flex; align-items:center; gap:10px;
  padding:14px 16px;
  background: linear-gradient(180deg, rgba(22,27,62,.75), rgba(16,21,48,.55));
  border-bottom:1px solid var(--line);
}
.bbdd-header h1{ margin:0; font-size:18px; font-weight:700; color:var(--ink); }
.spacer{ flex:1; }

/* --- Info card --- */
.gj-info{
  margin:14px 16px; padding:14px 16px;
  background: linear-gradient(180deg, rgba(19,24,54,.65), rgba(16,22,46,.55));
  border:1px solid var(--line);
  border-left:4px solid var(--brand);
  border-radius:12px;
  color:var(--ink);
  box-shadow: inset 0 1px 0 rgba(255,255,255,.03);
}
.gj-info .legend{
  margin-top:10px; display:flex; gap:14px; flex-wrap:wrap;
  font-size:12px; color:#bfc6ff;
}
.gj-info .legend span{
  background:#141a39; border:1px solid #2a3466;
  padding:6px 8px; border-radius:8px;
}

/* --- Tools bar (left/center/right) --- */
.bbdd-tools{
  display:grid;
  grid-template-columns: 1fr minmax(280px,520px) 1fr;
  align-items:center; gap:12px;
  padding:10px 16px;
}
.bbdd-tools .left{ justify-self:start; display:flex; gap:10px; align-items:center; }
.bbdd-tools .center{ justify-self:center; width:100%; }
.bbdd-tools .right{ justify-self:end; }

/* --- Inputs/Buttons --- */
.input, select, textarea{
  width:100%; outline:none;
  background: var(--input-bg);
  border:1px solid var(--input-brd);
  color:var(--ink);
  border-radius:12px; padding:9px 10px;
  transition: border-color .15s ease, box-shadow .15s ease;
}
.input::placeholder{ color:#b7c0ff; opacity:.9; }
.input:focus, select:focus, textarea:focus{
  border-color:#7d3cff; box-shadow:0 0 0 3px rgba(125,60,255,.18);
}

.btn{
  background:#7d3cff; color:#fff;
  border:1px solid rgba(125,60,255,.6);
  padding:9px 14px; border-radius:12px;
  font-weight:700; cursor:pointer;
}
.btn:hover{ filter:brightness(1.06); }
.btn.ghost{
  background: rgba(26,31,68,.6);
  border:1px solid rgba(122,134,255,.20);
  color:#cfd3ff;
}
.btn.success{ background:var(--ok); color:#072a18; border:1px solid #27dca0; }
.btn.danger{ background:var(--danger); border:1px solid #ff7682; }

.btn.loading{ opacity:.7; cursor:wait; position:relative; }
.btn.loading::after{
  content:""; position:absolute; right:12px; top:50%; transform:translateY(-50%);
  width:14px; height:14px; border:2px solid currentColor; border-top-color:transparent;
  border-radius:50%; animation: spin .8s linear infinite;
}
@keyframes spin{ to{ transform:translateY(-50%) rotate(360deg); } }

.dot{ margin-left:10px; color:#ffd56a; }
.hidden{ display:none !important; }

/* --- Table wrapper + sticky header + overlay spinner --- */
#table-wrap{
  position:relative;
  margin:0 16px 16px;
  border:1px solid var(--line-soft);
  border-radius:12px;
  background: linear-gradient(180deg, rgba(16,22,48,.55), rgba(13,18,40,.55));
  overflow:auto;                 /* el scroll vive ac√° */
  max-height:60vh;
}

/* Tabla */
#bbdd-table{
  width:100%;
  border-collapse:separate;
  border-spacing:0;
}
#bbdd-table thead th{
  position:sticky; top:0; z-index:3;
  padding:10px 12px; text-align:left;
  background: rgba(28,34,82,.6);
  color:#dbe0ff;
  border-bottom:1px solid var(--line-soft);
}
#bbdd-table tbody td{
  padding:8px 10px;
  border-bottom:1px solid rgba(122,134,255,.12);
}
#bbdd-table tbody tr:hover{ background: rgba(28,34,82,.22); }

/* Chips feedback / acciones */
.feedback{ display:flex; gap:6px; align-items:center; justify-content:center; }
.feedback button{
  background: rgba(27,34,71,.6);
  border:1px solid rgba(122,134,255,.22);
  color:#cfd3ff; border-radius:10px; padding:6px 9px; font-size:12px; cursor:pointer;
}
.feedback button.active{
  background: rgba(90,105,214,.32); border-color:#5a69d6; color:#ecedff;
}
.handle{ cursor:grab; opacity:.7; }
.row-actions{ display:flex; gap:6px; align-items:center; justify-content:flex-end; }
.row-actions .mini{
  background: rgba(26,31,68,.6);
  border:1px solid rgba(122,134,255,.20);
  color:#cfd3ff; border-radius:10px; padding:6px 8px; font-size:12px;
}


/* --- Footer --- */
.bbdd-footer{
  padding:12px 16px; display:flex; align-items:center; gap:10px;
  border-top:1px solid var(--line);
  background: linear-gradient(180deg, rgba(18,22,45,.55), rgba(12,16,35,.55));
}

/* --- Scrollbar oscuro (evita ‚Äúbarra blanca‚Äù) --- */
#table-wrap::-webkit-scrollbar{ width:10px; height:10px; }
#table-wrap::-webkit-scrollbar-thumb{
  background: rgba(122,134,255,.28); border-radius:10px; border:2px solid transparent;
  background-clip: padding-box;
}
#table-wrap::-webkit-scrollbar-track{ background: transparent; }

/* --- AI sparkles (placeholder visual) --- */
.ai-sparkle{
  position:absolute; right:12px; top:12px;
  width:18px; height:18px; opacity:0; pointer-events:none;
  background: radial-gradient(circle,#ffd27e 20%, rgba(255,210,126,0) 60%);
  filter: drop-shadow(0 0 6px #ffd27e);
  animation: sparkle 900ms ease-out infinite;
}
@keyframes sparkle{
  0%{ transform:scale(.4); opacity:0; }
  30%{ transform:scale(1); opacity:.9; }
  100%{ transform:scale(.2); opacity:0; }
}

/* El contenedor necesita altura aunque no haya filas todav√≠a */
#table-wrap{
  position: relative;
  margin: 0 16px 16px;
  border: 1px solid var(--line-soft);
  border-radius: 12px;
  background: linear-gradient(180deg, rgba(16,22,48,.55), rgba(13,18,40,.55));
  overflow: auto;
  max-height: 60vh;

  /* üí° clave para que el spinner tenga ‚Äúlienzo‚Äù donde centrarse */
  min-height: 360px;        /* subilo a 420 si quer√©s m√°s */
}

/* --- √Årea de tabla con altura m√≠nima para que el overlay tenga ‚Äúlienzo‚Äù --- */
#table-wrap{
  position: relative;
  min-height: 380px;          /* sub√≠ a 420 si quer√©s */
  max-height: 60vh;
  overflow: auto;
  border-radius: 12px;
}

/* --- Spinner overlay centrado, con blur por detr√°s --- */
#table-spinner{
  position: absolute;
  inset: 0;
  display: none;              /* se muestra con .table-loading */
  z-index: 6;                 /* por encima del thead sticky */
  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
  background: rgba(10,12,24,.45);
  color: var(--ink);
  font-weight: 600;

  /* centrado perfecto y en fila */
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
}

/* Mostrar overlay mientras carga + ‚Äúapagar‚Äù la tabla */
#table-wrap.table-loading #table-spinner{ display: flex; }
#table-wrap.table-loading #bbdd-table{
  filter: blur(1px);
  opacity: .6;
  pointer-events: none;
}

/* Pieza giratoria + texto */
#table-spinner .ring{
  width: 28px; height: 28px; border-radius: 50%;
  border: 3px solid rgba(255,255,255,.18);
  border-top-color: var(--brand);
  animation: gj-spin .9s linear infinite;
}
@keyframes gj-spin{ to{ transform: rotate(360deg); } }
#table-spinner .txt{ font-weight: 600; opacity: .95; }

/* Header pegado (por si no lo ten√©s a√∫n) */
#bbdd-table thead th{
  position: sticky;
  top: 0;
  z-index: 3;
  background: #171a23;
  box-shadow: 0 1px 0 rgba(255,255,255,.04);
}






//========ULTIMO===================

/* === Blur sutil en panel y header === */
.bbdd-panel {
  background: linear-gradient(180deg, rgba(18,22,45,0.75), rgba(12,16,35,0.75));
  border: 1px solid rgba(122,134,255,0.18);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
}

.bbdd-header {
  background: linear-gradient(180deg, rgba(22,27,62,.75), rgba(16,21,48,.55));
  border-bottom: 1px solid rgba(122,134,255,0.16);
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
}

/* === Blur tambi√©n en la barra de herramientas (con filtro/AI) === */
.bbdd-tools {
  background: rgba(16, 20, 38, 0.45);
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  border-radius: 8px;
  padding: 10px 16px;
}

/* === Scrollbar m√°s discreto (oscuro y cuadrado) === */
.bbdd-table-wrap::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}
.bbdd-table-wrap::-webkit-scrollbar-track {
  background: rgba(20, 22, 35, 0.4);
}
.bbdd-table-wrap::-webkit-scrollbar-thumb {
  background: rgba(90, 105, 214, 0.6);
  border-radius: 4px;
}
.bbdd-table-wrap::-webkit-scrollbar-thumb:hover {
  background: rgba(125, 60, 255, 0.8);
}

//******************************************************************************/
//BARRA COMO ME GUSTA
/* === Tabla: wrapper scrolleable (necesario para sticky) === */
#table-wrap{
  position: relative;
  overflow: auto;
  max-height: 60vh;           /* ajust√° si quer√©s m√°s alto/bajo */
  border-radius: 14px;
}

/* === Tabla + header con degrad√© y sticky === */
#bbdd-table{
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  border-radius: 14px;
  overflow: hidden;           /* recorta puntas del header */
}

#bbdd-table thead th{
  position: sticky;
  top: 0;                     /* <- se ‚Äúfrena‚Äù arriba del wrapper */
  z-index: 3;
  padding: 10px 12px;
  background: linear-gradient(180deg, rgba(44,52,106,.85), rgba(26,31,68,.88)) !important;
  color: #dbe0ff;
  text-shadow: 0 1px 0 rgba(0,0,0,.35);
  border-bottom: 1px solid rgba(122,134,255,.22);
  border-right: 1px solid rgba(122,134,255,.10);
}
#bbdd-table thead th:first-child{ border-top-left-radius: 14px; }
#bbdd-table thead th:last-child{  border-top-right-radius: 14px; border-right: none; }

#bbdd-table tbody tr:hover{ background: rgba(28,34,82,.22); }


/*******************************************************************************/

//aca estaba movil antes==================================================================


//===============================ULTIMO ARREGLO====================
/* ========== BBDD ‚Äì FIX LAYOUT/SCROLL/STICKY (OVERRIDES) ========== */

/* 1) El panel es un contenedor flex de columna y controla el overflow */
.bbdd-panel{
  display: flex;
  flex-direction: column;
  overflow: hidden;            /* evita que el contenido se salga del panel */
}

/* 2) Wrapper de la tabla: crece, scrollea y no se sale del panel (desktop) */
#table-wrap{
  flex: 1 1 auto;              /* ocupa el alto libre del panel */
  min-height: 360px;           /* lienzo para el spinner y primeras filas */
  max-height: none;            /* lo maneja el flex, no un tope fijo */
  overflow: auto;              /* el scroll vive ac√° en desktop */
  margin: 0 16px 16px;         /* respeta padding visual del panel */
  border-radius: 14px;
}

/* 3) thead sticky en desktop dentro del #table-wrap */
#bbdd-table thead th{
  position: sticky;
  top: 0;                      /* se ‚Äúpega‚Äù al borde superior del wrapper */
  z-index: 3;                  /* por encima de filas y spinner tenue */
}

/* 4) Spinner centrado sobre la tabla mientras carga */
#table-spinner{
  position: absolute;
  inset: 0;
  align-items: center;
  justify-content: center;
  gap: 12px;
  z-index: 4;                  /* sobre thead, pero no tapa el header */
  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
  background: rgba(10,12,24,.45);
  color: var(--ink);
  font-weight: 600;
}
#table-wrap.table-loading #table-spinner{ display:flex; }
#table-wrap.table-loading #bbdd-table{ filter:blur(1px); opacity:.6; pointer-events:none; }

/* 5) Scrollbar oscuro del wrapper (evita ‚Äúbarra blanca‚Äù) */
#table-wrap::-webkit-scrollbar{ width:10px; height:10px; }
#table-wrap::-webkit-scrollbar-thumb{
  background: rgba(122,134,255,.28);
  border-radius: 10px;
  border: 2px solid transparent;
  background-clip: padding-box;
}
#table-wrap::-webkit-scrollbar-track{ background: transparent; }

/* 6) Overlay con blur m√°s fuerte para no distraer */
.bbdd-overlay{
  background: rgba(8,12,28,.55);
  backdrop-filter: blur(16px) saturate(1.08);
  -webkit-backdrop-filter: blur(16px) saturate(1.08);
}

/* 7) MOBILE: scrollea TODO el panel; la tabla NO tiene scroll propio */
@media (max-width: 768px){
  .bbdd-overlay{
    align-items: stretch;      /* panel ocupa toda la pantalla */
    padding: 0;
  }
  .bbdd-panel{
    height: 100vh;
    max-height: 100vh;
    overflow: auto;            /* el scroll general vive en el panel */
    border-radius: 0;
  }

  /* el wrapper deja de scrollear; solo act√∫a como contenedor visual */
  #table-wrap{
    flex: 0 0 auto;
    max-height: none;
    overflow: visible;
    margin: 0 12px 12px;
    border-radius: 14px;
  }

  /* thead sticky en m√≥vil respecto del viewport del panel */
  #bbdd-table thead th{
    position: sticky;
    top: 0;                    /* queda pegado arriba al scrollear el panel */
    z-index: 5;
  }
}

/* ====== STICKY LAYOUT EN DESKTOP ====== */
@media (min-width: 769px){
  /* Header fijo arriba */
  .bbdd-header{
    position: sticky;
    top: 0;
    z-index: 40;
  }

  /* Barra de herramientas fija debajo del header */
  .bbdd-tools{
    position: sticky;
    top: var(--sticky-tools-top, 64px); /* la ajustamos por JS */
    z-index: 39;
    background: rgba(16, 20, 38, 0.55);
    backdrop-filter: blur(6px);
    -webkit-backdrop-filter: blur(6px);
    border-bottom: 1px solid rgba(122,134,255,.16);
  }

  /* La tarjeta ‚ÄúIMPORTANTE‚Äù NO es sticky: se va al scrollear */
  .gj-info{ position: relative; }

  /* La tabla no se sale del contenedor y usa todo el alto disponible */
  #table-wrap{
    max-height: var(--table-max, 60vh); /* lo ajusta JS seg√∫n viewport */
    overflow: auto;
  }

  /* Header de la tabla pegado dentro del wrapper */
  #bbdd-table thead th{
    position: sticky;
    top: 0;
    z-index: 3;
  }
}

/* Scrollbar oscuro y discreto (por si tu sistema lo muestra) */
#table-wrap::-webkit-scrollbar{ width:10px; height:10px; }
#table-wrap::-webkit-scrollbar-thumb{
  background: rgba(122,134,255,.28);
  border-radius: 10px;
  border: 2px solid transparent;
  background-clip: padding-box;
}
#table-wrap::-webkit-scrollbar-track{ background: transparent; }


//=======MOVIL===================================/
/* ====== MOBILE FIX (hasta 768px) ====== */
@media (max-width: 768px){

  /* que el overlay/panel pueda scrollear todo el contenido */
  .bbdd-overlay{
    align-items: stretch;            /* panel ocupa alto completo */
    padding: 0;
  }
  .bbdd-panel{
    height: 100vh;                   /* usar toda la pantalla */
    max-height: 100vh;
    overflow: auto;                  /* scroll general del panel */
    border-radius: 14px;
  }

  /* header compacta */
  .bbdd-header{
    position: sticky; top: 0; z-index: 20;  /* queda fija arriba */
    padding: 12px 14px;
  }
  .bbdd-header h1{ font-size: 16px; }

  /* tarjeta "IMPORTANTE" m√°s compacta */
  .gj-info{
    margin: 12px 12px;
    padding: 12px;
    border-radius: 14px;
    font-size: 14px;
  }

  /* barra de herramientas en columnas (btn + filtro + AI) */
  .bbdd-tools{
    grid-template-columns: 1fr;      /* una sola columna */
    gap: 8px;
    padding: 8px 12px;
  }
  .bbdd-tools .left,
  .bbdd-tools .center,
  .bbdd-tools .right{
    justify-self: stretch;
  }

  /* >>> La tabla NO tiene scroll interno en mobile */
  .bbdd-table-wrap{
    max-height: none;                /* quita l√≠mite de alto */
    overflow: visible;               /* el scroll lo maneja el panel */
    border-radius: 14px;             /* mantiene curvitas */
  }

  /* el header sticky de la tabla puede molestar; lo desactivamos en mobile */
  #bbdd-table thead th{
    position: static;
    background: transparent;
    box-shadow: none;
  }

  /* spinner centrado igual funciona, pero dentro del wrap */
  #table-spinner{
    position: sticky;                /* permanece visible al cargar */
    top: 0;
    border-radius: 14px;
    margin: 0 12px;
  }

  /* inputs/botones un poco m√°s grandes para dedo */
  .input, select{ padding: 10px 12px; border-radius: 12px; }
  .btn{ padding: 10px 12px; border-radius: 12px; }

  /* curvitas consistentes para no ‚Äúcuadrar‚Äù las puntas */
  .bbdd-table{ border-radius: 14px; overflow: hidden; }
  #table-spinner{ border-radius: 14px; }
}

   /* (opcional) scrollbar m√°s discreto en todos los tama√±os */
   .bbdd-panel::-webkit-scrollbar,
   .bbdd-table-wrap::-webkit-scrollbar{ width: 8px; height: 8px; }
   .bbdd-panel::-webkit-scrollbar-thumb,
   .bbdd-table-wrap::-webkit-scrollbar-thumb{
     background: rgba(255,255,255,.14);
     border-radius: 10px;
   }
   
   /* Overlay de fondo: blur fuerte tipo glass */
   .bbdd-overlay{
     position: fixed;
     inset: 0;
     background: rgba(8, 12, 28, .55);          /* capa oscura */
     backdrop-filter: blur(16px) saturate(1.1); /* BLUR potente */
     -webkit-backdrop-filter: blur(16px) saturate(1.1);
     display:flex; align-items:center; justify-content:center;
     padding:24px;
     z-index: 9999;
   }
   
   /* Panel centrado y con bordes suaves */
   .bbdd-panel{
     background: linear-gradient(180deg, rgba(18,22,45,.86), rgba(12,16,35,.80));
     border: 1px solid rgba(122,134,255,.18);
     border-radius: 14px;                  /* curvitas coherentes */
     box-shadow: 0 24px 80px rgba(0,0,0,.55), inset 0 1px 0 rgba(255,255,255,.04);
   }


   /* === MOBILE: mostrar SOLO Tasks(4), Dificultad(5), Feedback(6) sin romper el DOM === */
   /* 1) Mantener colgroup pero colapsar 1,2,3 y 7 a ancho 0 */
   #bbdd-table col.col-pilar,
   #bbdd-table col.col-rasgo,
   #bbdd-table col.col-stat,
   #bbdd-table col.col-eliminar {
     width: 0 !important;
   }
   
   /* 2) Mantener las celdas como table-cell, pero invisibles y sin ancho */
   #bbdd-table thead th:nth-child(1),
   #bbdd-table thead th:nth-child(2),
   #bbdd-table thead th:nth-child(3),
   #bbdd-table thead th:nth-child(7),
   #bbdd-table tbody td:nth-child(1),
   #bbdd-table tbody td:nth-child(2),
   #bbdd-table tbody td:nth-child(3),
   #bbdd-table tbody td:nth-child(7) {
     padding: 0 !important;
     border: 0 !important;
     width: 0 !important;
     max-width: 0 !important;
     overflow: hidden !important;
     white-space: nowrap !important;
     font-size: 0 !important;   /* evita ‚Äúfantasmas‚Äù de texto */
   }
   
   /* 3) Barra fija de columnas: conservar 7 tracks pero colapsar 1,2,3 y 7 */
   .bbdd-columns{
     /* 0 0 0 | Tasks | Dificultad | Feedback | 0 */
     grid-template-columns: 0 0 0 1fr 0.45fr 0.45fr 0 !important;
   }
   .bbdd-columns > div:nth-child(1),
   .bbdd-columns > div:nth-child(2),
   .bbdd-columns > div:nth-child(3),
   .bbdd-columns > div:nth-child(7){
     padding: 0 !important; margin: 0 !important; border: 0 !important;
     height: 0 !important; overflow: hidden !important;
     opacity: 0 !important; pointer-events: none !important;
   }
   
   /* 4) Evitar solape del texto de Tasks */
   #bbdd-table tbody td:nth-child(4){
     white-space: nowrap;
     overflow: hidden;
     text-overflow: ellipsis;
   }


/=============MOVIL====================================
/* =============================
   BBDD ‚Äì OVERRIDES FINALES
   (PEGAR AL FINAL DEL CSS)
   ============================= */

/* ======= MOBILE (‚â§768px) ======= */
@media (max-width: 768px){

  /* 1) Colapsar columnas 1,2,3 y 7 sin sacarlas del DOM */
  #bbdd-table col.col-pilar,
  #bbdd-table col.col-rasgo,
  #bbdd-table col.col-stat,
  #bbdd-table col.col-eliminar{
    width: 0 !important;
  }

  #bbdd-table thead th:nth-child(1),
  #bbdd-table thead th:nth-child(2),
  #bbdd-table thead th:nth-child(3),
  #bbdd-table thead th:nth-child(7),
  #bbdd-table tbody td:nth-child(1),
  #bbdd-table tbody td:nth-child(2),
  #bbdd-table tbody td:nth-child(3),
  #bbdd-table tbody td:nth-child(7){
    padding: 0 !important;
    border: 0 !important;
    width: 0 !important;
    max-width: 0 !important;
    overflow: hidden !important;
    white-space: nowrap !important;
    font-size: 0 !important; /* evita que se filtre texto */
  }

  /* 2) Barra fija .bbdd-columns: 7 tracks, colapsar 1,2,3 y 7 */
  .bbdd-columns{
    /* 0 0 0 | Tasks | Dificultad | Feedback | 0 */
    grid-template-columns: 0 0 0 1fr 0.5fr 0.5fr 0 !important;
  }
  .bbdd-columns > div:nth-child(1),
  .bbdd-columns > div:nth-child(2),
  .bbdd-columns > div:nth-child(3),
  .bbdd-columns > div:nth-child(7){
    padding: 0 !important; margin: 0 !important; border: 0 !important;
    height: 0 !important; overflow: hidden !important;
    opacity: 0 !important; pointer-events: none !important;
  }

  /* 3) Que Tasks no se solape al achicarse */
  #bbdd-table tbody td:nth-child(4){
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
  }

  /* 4) Scroll general del panel en mobile (la tabla no scrollea adentro) */
  .bbdd-panel{ height: 100vh; max-height: 100vh; overflow: auto !important; }
  #table-wrap{ overflow: visible !important; max-height: none !important; }
}

/* ======= DESKTOP (‚â•769px) ======= */
@media (min-width: 769px){

  /* Restaurar anchos del colgroup */
  #bbdd-table col.col-pilar      { width: var(--w-pilar) !important; }
  #bbdd-table col.col-rasgo      { width: var(--w-rasgo) !important; }
  #bbdd-table col.col-stat       { width: var(--w-stat) !important; }
  #bbdd-table col.col-task       { width: var(--w-task) !important; }
  #bbdd-table col.col-dificultad { width: var(--w-dificultad) !important; }
  #bbdd-table col.col-feedback   { width: var(--w-feedback) !important; }
  #bbdd-table col.col-eliminar   { width: var(--w-eliminar) !important; }

  /* Volver a mostrar celdas 1,2,3 y 7 normales */
  #bbdd-table thead th:nth-child(1),
  #bbdd-table thead th:nth-child(2),
  #bbdd-table thead th:nth-child(3),
  #bbdd-table thead th:nth-child(7),
  #bbdd-table tbody td:nth-child(1),
  #bbdd-table tbody td:nth-child(2),
  #bbdd-table tbody td:nth-child(3),
  #bbdd-table tbody td:nth-child(7){
    padding: 6px 10px !important;
    border-width: 1px !important;
    width: auto !important;
    max-width: none !important;
    overflow: visible !important;
    white-space: normal !important;
    font-size: inherit !important;
  }

  /* Barra fija completa (7 pistas) */
  .bbdd-columns{
    grid-template-columns:
      var(--w-pilar) var(--w-rasgo) var(--w-stat)
      var(--w-task) var(--w-dificultad) var(--w-feedback) var(--w-eliminar) !important;
  }
  .bbdd-columns > div{
    opacity: 1 !important; height: auto !important; pointer-events: auto !important;
  }

  /* El scroll de la tabla vuelve al wrapper en desktop */
  #table-wrap{
    overflow: auto !important;
    max-height: var(--table-max, 60vh) !important;
  }
}
